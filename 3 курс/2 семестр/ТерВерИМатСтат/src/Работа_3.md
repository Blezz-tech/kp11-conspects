# Занятие 03. 05.02.2024 . Условная вероятность. Получение непрерывного бета-распределения

## Концепт-карты

### Концепт-карта Глава 5

![Рисунок 1. Концепт-карта Глава 5](./Картинки/Работа_3/Глава_5.jpg)

### Концепт-карта Глава 6

![Рисунок 2. Концепт-карта Глава 6](./Картинки/Работа_3/Глава_6.jpg)


## Задача 1

### Условие задачи

Вы хотите использовать бета-распределение, чтобы определить, честная
ли монетка — то есть равны ли для нее вероятности выкинуть орел
и решку. Вы подбрасываете монетку $10$ раз и получаете $4$ орла и $6$ решек.
Используя бета-распределение, найдите вероятность того, что орел выпадает
в более чем $60\%$ бросков.

### Решение задачи

Формула бета-распределения описывает плотность вероятности функции (PDF) для случайной величины, которая следует бета-распределению. Формула имеет вид:

$$
f(p; \alpha, \beta) = \frac{p^{\alpha - 1}(1 - p)^{\beta - 1}}{\text{B}(\alpha, \beta)}
$$

где:

$p$ - это случайная величина, которая принимает значения от $0$ до $1$,

$\alpha$ и $\beta$ - это параметры распределения,

$\text{B}(\alpha, \beta)$ - это функция бета, которая обычно определяется как:

$$
\text{B}(\alpha, \beta) = \frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)}
$$

где $\Gamma$ обозначает гамма-функцию.

Мы применяем формулу бета-распределения в данной задаче, потому что она
позволяет моделировать вероятность выпадения орла при подбрасывании монетки.
Бета-распределение является подходящим выбором для такого рода задач, поскольку
оно может быть использовано для описания вероятностей между 0 и 1 и имеет два
параметра, которые могут быть интерпретированы как количество "успехов" и
"неудач". В контексте подброса монетки, "успех" - это выпадение орла, а
"неудача" - решка.

Применим эту формулу к задаче о монете: если мы подбросили монету 10 раз и
увидели 4 орла и 6 решек, то мы можем предположить, что распределение
вероятностей выпадения орла приближается к бета-распределению с параметрами α=4
и β=6. Эти параметры затем используются для вычисления вероятности того, что
истинная вероятность выпадения орла превысит 0.6 (60%) при дополнительных
бросках монетки.

Мы моделируем ситуацию как Beta(4,6), что соответствует нашим данным о бросках
монетки. Чтобы вычислить вероятность того, что истинная вероятность выпадения
орла составляет  60% или больше, нужно вычислить интеграл от  0.6 до  1 по
плотности вероятности бета-распределения. Это можно сделать в R следующим
образом:

```r
integrate(function(x) dbeta(x,  4,  6),  0.6,  1)$value
```

Результатом этого вычисления будет приближенное значение интеграла, которое
представляет собой вероятность того, что истинная вероятность выпадения орла
составляет  60% или больше. Если результат близок к  0.1, это означает, что с
вероятностью около  10% можно заключить, что истинная вероятность выпадения орла составляет  60% или больше [0].

### Ответ

Ответ: `10%`

### Проверка

```python
import numpy as np

# Количество испытаний (бросков монетки)
N =  100000

# Вероятность которую мы вычислили с помощью R
P_formula = 0.1


# Параметры бета-распределения
alpha =  4
beta =  6

# Генерация случайных чисел, соответствующих бета-распределению
random_numbers = np.random.beta(alpha, beta, N)

# Подсчет числа случайных чисел, превышающих  0.6
n = sum(random_number >  0.6 for random_number in random_numbers)

# Вычисление вероятности
P_result = n / N

print("Проверено последовательностей: ", N)
print("Успешных последовательностей n: ", n)
print("")
print("Приближенное отношение:", '{:.40f}'.format(P_result))
print("Вероятность по формуле:", '{:.40f}'.format(P_formula))
print("")
print("Абсолютное расхождение:", '{:.40f}'.format(abs(P_result - P_formula)))
print("Отноосительное расхождение:", '{:.40f}'.format(abs(P_result - P_formula) / P_formula * 100))
```

## Задача 2

### Условие задачи

Вы еще $10$ раз подбрасываете монетку и в итоге получаете $9$ орлов
и $11$ решек. Какова вероятность того, что монетка честная, используя
наше определение честности плюс-минус $5\%$?


### Решение задачи

После того как вы подбросили монетку  10 раз и получили  4 орла и  6 решек, вы
можете использовать бета-распределение для оценки вероятности того, что монетка
честная, то есть вероятность выпадения орла равна  0,5 с некоторой
неопределенностью. Для этого вам нужно определить параметры бета-распределения,
которые соответствуют вашим данным. В данном случае, параметр α (число успехов)
равен  4, а параметр  β (число неудач) равен  6. Таким образом, у вас получается
бета-распределение Beta(4,  6).

Теперь, чтобы определить вероятность того, что монетка честная, с учетом новой
информации о вероятности выпадения орла, вам нужно интегрировать
бета-распределение между  0,45 и  0,55. Это соответствует интервалу отклонения
плюс-минус  5% от ожидаемой вероятности выпадения орла, который равен  0,5. В R
это можно сделать с помощью функции `integrate`:

```r
integrate(function(x) dbeta(x,  9,  11),  0.45,  0.55)
```

Результатом этого интегрирования будет вероятность того, что монетка честная, с
учетом новых данных. Если результат интегрирования близко к  0,3, это означает,
что существует около  30% вероятности того, что монетка честная, учитывая последние  10 бросков.

### Ответ

Ответ: `30%`

### Проверка

```python
import scipy.stats as stats
from scipy.integrate import quad

# Вероятность которую мы вычислили с помощью R
P_formula = 0.3

# Параметры бета-распределения
alpha =  9
beta =  11

# Определение функции распределения beta
dbeta = lambda x, alpha, beta: stats.beta.pdf(x, alpha, beta)

# Интеграция функции от  0.45 до  0.55
P_result, error = quad(dbeta,  0.45,  0.55, args=(alpha,  beta))

print("Приближенное отношение:", '{:.40f}'.format(P_result))
print("Вероятность по формуле:", '{:.40f}'.format(P_formula))
print("")
print("Абсолютное расхождение:", '{:.40f}'.format(abs(P_result - P_formula)))
print("Отноосительное расхождение:", '{:.40f}'.format(abs(P_result - P_formula) / P_formula * 100))
```


## Задача 3

### Условие задачи

Данные — лучший способ убедиться в верности своих утверждений.
Вы еще $200$ раз подбрасываете монетку и в итоге получаете $109$ орлов
и $111$ решек. Какова теперь вероятность того, что монетка честная
(плюс-минус $5\%$)?

### Решение задачи

После того как вы подбросили монетку  220 раз и получили  109 орла и  111 решек,
вы можете использовать бета-распределение для оценки вероятности того, что
монетка честная, то есть вероятность выпадения орла равна  0,45 с некоторой
неопределенностью. Для этого вам нужно определить параметры бета-распределения,
которые соответствуют вашим данным. В данном случае, параметр α (число успехов) равен  109, а параметр  β (число неудач) равен  111. Таким образом, у вас получается бета-распределение Beta(109, 111).

Теперь, чтобы определить вероятность того, что монетка честная, с учетом новой
информации о вероятности выпадения орла, вам нужно интегрировать
бета-распределение между  0,45 и  0,55. Это соответствует интервалу отклонения
плюс-минус  5% от ожидаемой вероятности выпадения орла, который равен  0,5. В R
это можно сделать с помощью функции `integrate`:

```r
integrate(function(x) dbeta(x,109,111),0.45,0.55)
```

Результатом этого интегрирования будет вероятность того, что монетка честная, с
учетом новых данных. Если результат интегрирования близко к  0,3, это означает,
что существует около  30% вероятности того, что монетка честная, учитывая
последние  10 бросков.

### Ответ

Ответ: `30%`

### Проверка

```python
import scipy.stats as stats
from scipy.integrate import quad

# Вероятность которую мы вычислили с помощью R
P_formula = 0.86

# Параметры бета-распределения
alpha =  109
beta =  111

# Определение функции распределения beta
dbeta = lambda x, alpha, beta: stats.beta.pdf(x, alpha, beta)

# Интеграция функции от  0.45 до  0.55
P_result, error = quad(dbeta,  0.45,  0.55, args=(alpha,  beta))

print("Приближенное отношение:", '{:.40f}'.format(P_result))
print("Вероятность по формуле:", '{:.40f}'.format(P_formula))
print("")
print("Абсолютное расхождение:", '{:.40f}'.format(abs(P_result - P_formula)))
print("Отноосительное расхождение:", '{:.40f}'.format(abs(P_result - P_formula) / P_formula * 100))
```

## Задача 4

### Условие задачи

Мы хотим использовать теорему Байеса для определения вероятности
того, что в $2010$ году пациент с синдромом Гийена — Барре был привит
от гриппа. Какая информация нам нужна?

### Решение задачи



### Ответ



### Проверка



## Задача 5

### Условие задачи

Какова вероятность того, что случайно выбранный из всей популяции
человек — женщина и не дальтоник?

### Решение задачи



### Ответ



### Проверка



## Задача 6

### Условие задачи

Какова вероятность того, что мужчина, привитый от гриппа в $2010$ году,
будет страдать либо от дальтонизма, либо от синдрома Гийена — Барре?

### Решение задачи



### Ответ



### Проверка



