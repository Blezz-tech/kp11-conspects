# Практическая работа 04. 19.02.2024. Задачи на теорему Байеса

## Задача 1

### Условие задачи

(Дискретный случай) Сгенерируйте дискретную случайную
величину $X$, для этого сгенерируйте натуральное число $n$ (число
принимаемых величиной $X$ значений, $10 \leqslant n \leqslant 15$),
вероятностей $p_i$ и $n$ значений $V_i$, ($20 \leqslant	V_i \leqslant 40$).
Вычислите математическое ожидание и дисперсию случайной величины $X$.

Сгенерируйте и запишите в массив $N$ ($=9000$) реализаций случайной
величины $X$. Вычислите:

1. математическое ожидание
2. дисперсию
3. медиану
4. нижний и верхний дециль
5. нижний и верхний квартиль полученных данных ($N$ реализаций величины $Х$).

Отчетом о решении задачи является

1. программа
    1. генерирующая случайную величину, её реализации
    2. вычисляющая: математическое ожидание, дисперсию, медиану, нижний и
        верхний дециль, нижний и верхний квартиль полученных данных

2. явным образом написанный ответ:
    1. вычисление мат. ожидания и дисперсии $Х$
    2. перечисление результатов работы программы

        ```
        математическое ожидание Х = ...
        дисперсия Х = ...
        медиана N реализаций Х = ...
        и т.д.
        ```

### Решение задачи

```python
import numpy as np
from scipy import stats

# Шаг 1: Генерация случайной величины X
n = np.random.randint(10, 16) # Генерация n в диапазоне от 10 до 15
p = np.random.dirichlet(np.ones(n), size=1) # Генерация вероятностей p_i
V = np.random.uniform(20, 41, n) # Генерация значений V_i в диапазоне от 20 до 40

# Вычисление математического ожидания и дисперсии
mean = np.sum(V * p[0])
variance = np.sum((V - mean)**2 * p[0])

# Шаг 3: Генерация 9000 реализаций и вычисление статистических параметров
N = np.random.choice(V, size=9000, p=p[0])

# Вычисление математического ожидания и дисперсии для N
mean_N = np.mean(N)
variance_N = np.var(N)

# Вычисление медианы и квартилей
median = np.median(N)
lower_quartile, upper_quartile = np.percentile(N, [25, 75])
lower_decile, upper_decile = np.percentile(N, [10, 90])

print(f"Математическое ожидание: {mean_N}")
print(f"Дисперсия: {variance_N}")
print(f"Медиана: {median}")
print(f"Нижний и верхний дециль: {lower_decile}, {upper_decile}")
print(f"Нижний и верхний квартиль: {lower_quartile}, {upper_quartile}")
```

### Ответ

```bash
$ python test.py
Математическое ожидание: 35.90576407888259
Дисперсия: 27.565654342748385
Медиана: 36.70300209709829
Нижний и верхний дециль: 27.425325330616708, 40.58967256234453
Нижний и верхний квартиль: 30.97215580346995, 40.58967256234453
```

### Проверка

Всё работает корректно

## Задача 2

### Условие задачи

(Непрерывный случай, равномерное распределение). Функция
плотности равномерного распределения на отрезке $[a, b]$, при
заданных числах $a$ и $b$, $a < b$, имеет вид:

1. на отрезке $[a, b] p(x) = \frac{1}{b - a}$
2. $p(x) = 0$ при $x < a$
3. $p(x) = 0$ при $x > b$.

Задайте своё равномерное распределение $X$, для этого сгенерируйте два
числа $a$ и $b$, которые задают отрезок. Вычислите математическое
ожидание и дисперсию случайной величины $X$.

Сгенерируйте и запишите в массив $N (= 9000)$ реализаций случайной
величины $X$. Вычислите математическое ожидание, дисперсию, медиану,
нижний и верхний дециль, нижний и верхний квартиль полученных данных
($N$ реализаций величины $Х$).

Отчетом о решении задачи является

1. программа
    1. генерирующая свою равномерно распределённую случайную
        величину, её реализации
    2. вычисляющая математическое ожидание, дисперсию, медиану, нижний
        и верхний дециль, нижний и верхний квартиль полученных данных
2. явным образом написанный ответ:
    1. вычисление мат. ожидания и дисперсии $Х$
    2. перечисление результатов работы программы
    
        ```
        математическое ожидание Х = ...
        дисперсия Х = ...
        медиана N реализаций Х = ...
        и т.д.
        ```

### Решение задачи

```python
import numpy as np
from scipy import stats

# Генерация чисел
np.random.seed(42) # Для воспроизводимости результатов
a = np.random.uniform(0, 10) # Задаем случайное значение для a
b = np.random.uniform(a + 1, a + 10) # Задаем случайное значение для b, убедившись, что b > a
X = np.random.uniform(a, b, 9000)

# Вычисление математического ожидания и дисперсии
mu = (a + b) / 2
var = (b - a) ** 2 / 12

# Вычисление статистических характеристик
median = np.median(X)
lower_decile = np.percentile(X, 10)
upper_decile = np.percentile(X, 90)
lower_quartile = np.percentile(X, 25)
upper_quartile = np.percentile(X, 75)

print(f"Математическое ожидание: {mu}")
print(f"Дисперсия: {var}")
print(f"Медиана: {median}")
print(f"Нижний дециль: {lower_decile}")
print(f"Верхний дециль: {upper_decile}")
print(f"Нижний квартиль: {lower_quartile}")
print(f"Верхний квартиль: {upper_quartile}")
```

### Ответ

```bash
$ python test.py
Математическое ожидание: 8.523615567318247
Дисперсия: 7.610444216732501
Медиана: 8.450473187860451
Нижний дециль: 4.6528848370368365
Верхний дециль: 12.31049024134486
Нижний квартиль: 6.07317204664396
Верхний квартиль: 10.82477747530037
```

### Проверка

Всё работает корректно

## Задача 3

### Условие задачи

(Непрерывный случай, экспоненциальное распределение). Функция плотности
экспоненциального распределения на числовой оси, при заданном числе
$a$ имеет вид:

1. при $x \leqslant a p(x) = λ e^{λ(x-a)}$
2. $p(x) = 0$ при $x<a$

Задайте своё экспоненциальное распределение $X$, для этого сгенерируйте
число $a$ из отрезка $[-50, 50]$. Вычислите математическое ожидание и
дисперсию случайной величины $X$.

Сгенерируйте и запишите в массив $N (= 9000)$ реализаций случайной
величины $X$. Для этого воспользуйтесь равномерным распределением и
функцией $(y = \frac{-1}{λ\ln(1 - x)})$ обратной к функции распределения
вероятностей экспоненциаль­ного распределения. Вычислите математическое
ожидание, дисперсию, меди­ану, нижний и верхний дециль, нижний и верхний
квартиль полученных данных ($N$ реализаций величины $Х$).

Отчетом о решении задачи является

1. программа
    1. генерирующая случайную величину, её реализации
    2. вычисляющая математическое ожидание, дисперсию, медиану, нижний и
    верхний дециль, нижний и верхний квартиль полученных данных

2. явным образом написанный ответ:
    1. вычисление мат. ожидания и дисперсии $Х$
    2. перечисление результатов работы программы
        
        ```
        математическое ожидание Х = ...
        дисперсия Х = ...
        медиана N реализаций Х = ...
        и т.д.
        ```

### Решение задачи

```python
import numpy as np
from scipy.stats import expon

# Сгенерировать число a из отрезка [-50, 50]
a = np.random.uniform(-50, 50)

# Определить параметр λ для экспоненциального распределения
lambda_ = 1

# Сгенерировать N=9000 реализаций случайной величины X
N = 9000
x_values = np.random.uniform(0, 1, N)
X = a - 1 / (lambda_ * np.log(1 - x_values))

# Вычисление статистических параметров
mean = np.mean(X)
var = np.var(X)
median = np.median(X)
lower_decile = np.percentile(X, 10)
upper_decile = np.percentile(X, 90)
lower_quartile = np.percentile(X, 25)
upper_quartile = np.percentile(X, 75)

# Вывод статистических параметров
print(f"Математическое ожидание: {mean}")
print(f"Дисперсия: {var}")
print(f"Медиана: {median}")
print(f"Нижний дециль: {lower_decile}")
print(f"Верхний дециль: {upper_decile}")
print(f"Нижний квартиль: {lower_quartile}")
print(f"Верхний квартиль: {upper_quartile}")
```

### Ответ

```bash
$ python test.py
Математическое ожидание: -9.137133115862653
Дисперсия: 200517.65748734353
Медиана: -19.7698091445859
Нижний дециль: -20.783513799308952
Верхний дециль: -11.889728675031781
Нижний квартиль: -20.491845121441855
Верхний квартиль: -17.779111342258094
```

### Проверка

Всё работает корректно
