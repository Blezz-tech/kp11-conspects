# Практическая работа 06. 07.03.2024 Моделирование распределений вероятностей

## Задача 1

### Условие задачи

Сгенерируйте дискретную случайную величину X, с распределением Бернулли

$$
P \{X = 1\} = p, P \{X = 0\} = q, q = 1 - p, 0 < p < 1
$$

Сгенерируйте и запишите в массив $N (= 100 000, 200 000, 500 000)$
реализаций случайной величины $X$. Вычислите математическое ожидание,
дисперсию, медиану, нижний и верхний дециль, нижний и верхний квартиль
полученных данных ($N$ реализаций величины $Х$).

Отчетом о решении задачи является 

1. программа
    1. генерирующая свою равномерно распределённую случайную
        величину, её реализации
    2. вычисляющая математическое ожидание, дисперсию, медиану, нижний
        и верхний дециль, нижний и верхний квартиль полученных данных
2. явным образом написанный ответ:
    1. вычисление мат. ожидания и дисперсии $Х$
    2. перечисление результатов работы программы
    
        ```
        математическое ожидание Х = ...
        дисперсия Х = ...
        медиана N реализаций Х = ...
        и т.д.
        ```

### Решение задачи

```python
import numpy as np
from scipy.stats import bernoulli

# Параметры распределения Бернулли
p = 0.5 # Пример значения p, можно изменить
q = 1 - p

# Генерация N реализаций случайной величины X
N_values = [100000, 200000, 500000]

for N in N_values:
    # Генерация N реализаций
    X = bernoulli.rvs(p, size=N)
    
    # Вычисление математического ожидания
    mean_X = np.mean(X)
    
    # Вычисление дисперсии
    var_X = np.var(X)
    
    # Вычисление медианы
    median_X = np.median(X)
    
    # Вычисление нижнего и верхнего децилей
    lower_decile_X = np.percentile(X, 10)
    upper_decile_X = np.percentile(X, 90)
    
    # Вычисление нижнего и верхнего квартилей
    lower_quartile_X = np.percentile(X, 25)
    upper_quartile_X = np.percentile(X, 75)
    
    print(f"Для N = {N}:")
    print(f"Математическое ожидание X = {mean_X}")
    print(f"Дисперсия X = {var_X}")
    print(f"Медиана N реализаций X = {median_X}")
    print(f"Нижний дециль = {lower_decile_X}, Верхний дециль = {upper_decile_X}")
    print(f"Нижний квартиль = {lower_quartile_X}, Верхний квартиль = {upper_quartile_X}")
    print("\n")
```

### Ответ

```
$ python test.py 
Для N = 100000:
Математическое ожидание X = 0.50222
Дисперсия X = 0.24999507159999992
Медиана N реализаций X = 1.0
Нижний дециль = 0.0, Верхний дециль = 1.0    
Нижний квартиль = 0.0, Верхний квартиль = 1.0


Для N = 200000:
Математическое ожидание X = 0.49809
Дисперсия X = 0.24999635189999997
Медиана N реализаций X = 0.0
Нижний дециль = 0.0, Верхний дециль = 1.0    
Нижний квартиль = 0.0, Верхний квартиль = 1.0


Для N = 500000:
Математическое ожидание X = 0.499708
Дисперсия X = 0.24999991473599995
Медиана N реализаций X = 0.0
Нижний дециль = 0.0, Верхний дециль = 1.0
Нижний квартиль = 0.0, Верхний квартиль = 1.0
```

### Проверка

Всё работает корректно

## Задача 2

### Условие задачи

Биномиальное распределение

$$
P \{X = k\} = C_n^k p^k q^{n-k}, k = 0,1...,n , q = 1 - p, 0 < p < 1
$$

Сгенерируйте и запишите в массив $N (= 100 000, 200 000, 500 000)$
реализаций случайной величины $X$. Вычислите математическое ожидание,
дисперсию, медиану, нижний и верхний дециль, нижний и верхний квартиль
полученных данных ($N$ реализаций величины $Х$).

Отчетом о решении задачи является 

1. программа
    1. генерирующая свою равномерно распределённую случайную
        величину, её реализации
    2. вычисляющая математическое ожидание, дисперсию, медиану, нижний
        и верхний дециль, нижний и верхний квартиль полученных данных
2. явным образом написанный ответ:
    1. вычисление мат. ожидания и дисперсии $Х$
    2. перечисление результатов работы программы
    
        ```
        математическое ожидание Х = ...
        дисперсия Х = ...
        медиана N реализаций Х = ...
        и т.д.
        ```


### Решение задачи

```python
import numpy as np
from scipy.stats import binom, percentileofscore

# Параметры биномиального распределения
n = 10 # количество испытаний
p = 0.5 # вероятность успеха

# Генерация случайных чисел
N_values = [100000, 200000, 500000]
X_values = {}

for N in N_values:
    X = np.random.binomial(n, p, N)
    X_values[N] = X

# Вычисление статистических параметров
for N, X in X_values.items():
    mean = np.mean(X)
    var = np.var(X)
    median = np.median(X)
    lower_decile = np.percentile(X, 10)
    upper_decile = np.percentile(X, 90)
    lower_quartile = np.percentile(X, 25)
    upper_quartile = np.percentile(X, 75)
    
    print(f"Для N = {N}:")
    print(f"Математическое ожидание X = {mean}")
    print(f"Дисперсия X = {var}")
    print(f"Медиана N реализаций X = {median}")
    print(f"Нижний дециль = {lower_decile}")
    print(f"Верхний дециль = {upper_decile}")
    print(f"Нижний квартиль = {lower_quartile}")
    print(f"Верхний квартиль = {upper_quartile}")
    print("\n")

```

### Ответ

```
$ python test.py 
Для N = 100000:
Математическое ожидание X = 4.99227
Дисперсия X = 2.4923702470999998   
Медиана N реализаций X = 5.0       
Нижний дециль = 3.0
Верхний дециль = 7.0
Нижний квартиль = 4.0
Верхний квартиль = 6.0


Для N = 200000:
Математическое ожидание X = 5.00719
Дисперсия X = 2.4973783039000006   
Медиана N реализаций X = 5.0
Нижний дециль = 3.0
Верхний дециль = 7.0
Нижний квартиль = 4.0
Верхний квартиль = 6.0


Для N = 500000:
Математическое ожидание X = 4.9997
Дисперсия X = 2.4959039099999996
Медиана N реализаций X = 5.0
Нижний дециль = 3.0
Верхний дециль = 7.0
Нижний квартиль = 4.0
Верхний квартиль = 6.0
```

### Проверка

Всё работает корректно

## Задача 3

### Условие задачи

нормальное распределение

$$
f(x) \frac{1}{\sqrt{2 \pi} \sigma} e^{\frac{(x-a)^2}{a\sigma^2}},
a \in \mathbb{R}, \sigma > 0, x \in \mathbb{R}
$$

Задайте своё нормальное распределение $X$, для этого сгенерируйте число
$a$ и $\sigma$. Вычислите математическое ожидание и дисперсию случайной
величины X.

Сгенерируйте и запишите в массив $N (= 100 000, 200 000, 500 000)$
реализаций случайной величины $X$. Для этого воспользуйтесь равномерны
распределением и функцией $(y = – \frac{1}{\lambda ln(1-x)})$ обратной к
функции распределения вероятностей экспоненциаль¬ного распределения.
Вычислите математическое ожидание, дисперсию, меди¬ану, нижний и верхний
дециль, нижний и верхний квартиль полученных данных ($N$ реализаций
величины $Х$).

Отчетом о решении задачи является 

1. программа
    1. генерирующая свою равномерно распределённую случайную
        величину, её реализации
    2. вычисляющая математическое ожидание, дисперсию, медиану, нижний
        и верхний дециль, нижний и верхний квартиль полученных данных
2. явным образом написанный ответ:
    1. вычисление мат. ожидания и дисперсии $Х$
    2. перечисление результатов работы программы
    
        ```
        математическое ожидание Х = ...
        дисперсия Х = ...
        медиана N реализаций Х = ...
        и т.д.
        ```


### Решение задачи

```python
import numpy as np
from scipy.stats import expon

# Генерация параметров a и sigma
a = np.random.uniform(-10, 10) # Примерное значение, можно изменить
sigma = np.random.uniform(1, 10) # Примерное значение, можно изменить

# Генерация N реализаций случайной величины X
N_values = [100000, 200000, 500000]

# Шаг 1: Генерация нормального распределения и вычисление его характеристик
for N in N_values:
    # Генерация N реализаций
    X = np.random.normal(a, sigma, N)
    
    # Вычисление математического ожидания и дисперсии
    mean_X = np.mean(X)
    var_X = np.var(X)
    
    print(f"Для N = {N} (нормальное распределение):")
    print(f"Математическое ожидание X = {mean_X}")
    print(f"Дисперсия X = {var_X}")

# Шаг 2: Генерация и анализ данных с использованием равномерного распределения
for N in N_values:
    # Генерация равномерных случайных чисел
    uniform_samples = np.random.uniform(0, 1, N)
    
    # Преобразование в экспоненциальное распределение
    X_exp = -np.log(1 - uniform_samples)
    
    # Вычисление статистических характеристик
    mean_X_exp = np.mean(X_exp)
    var_X_exp = np.var(X_exp)
    median_X_exp = np.median(X_exp)
    deciles_X_exp = np.percentile(X_exp, [10, 90])
    quartiles_X_exp = np.percentile(X_exp, [25, 75])
    
    print(f"Для N = {N} (экспоненциальное распределение):")
    print(f"Математическое ожидание X = {mean_X_exp}")
    print(f"Дисперсия X = {var_X_exp}")
    print(f"Медиана X = {median_X_exp}")
    print(f"Нижний и верхний дециль X = {deciles_X_exp}")
    print(f"Нижний и верхний квартиль X = {quartiles_X_exp}")
```

### Ответ

```
$ python test.py 
Для N = 100000 (нормальное распределение):
Математическое ожидание X = 7.4713688496078925  
Дисперсия X = 63.14159726963313
Для N = 200000 (нормальное распределение):      
Математическое ожидание X = 7.434527743435389   
Дисперсия X = 63.103577494245926
Для N = 500000 (нормальное распределение):      
Математическое ожидание X = 7.437848292682932   
Дисперсия X = 63.169757289252274
Для N = 100000 (экспоненциальное распределение):
Математическое ожидание X = 1.0025933281191628  
Дисперсия X = 0.9982267138394082
Медиана X = 0.6972731617420703
Нижний и верхний дециль X = [0.10428438 2.31239722]
Нижний и верхний квартиль X = [0.29002297 1.39010074]
Для N = 200000 (экспоненциальное распределение):
Математическое ожидание X = 0.9961030152247528
Дисперсия X = 0.988192795616265
Медиана X = 0.6916395408105713
Нижний и верхний дециль X = [0.10387825 2.29312931]
Нижний и верхний квартиль X = [0.28601316 1.37971617]
Для N = 500000 (экспоненциальное распределение):
Математическое ожидание X = 0.9987561856544996
Дисперсия X = 0.9971694014586756
Медиана X = 0.6922414665973073
Нижний и верхний дециль X = [0.1055479  2.29958798]
Нижний и верхний квартиль X = [0.2870127  1.38489464]
```

### Проверка

Всё работает корректно
