<!DOCTYPE html>
<html><head>
			
		<title>py Конвертация txt в xlsx</title>
		<base href="../">
		<meta id="root-path" root-path="../">

		<link rel="icon" sizes="96x96" href="https://publish-01.obsidian.md/access/f786db9fac45774fa4f0d8112e232d67/favicon-96x96.png">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<script src="https://code.iconify.design/iconify-icon/1.0.3/iconify-icon.min.js"></script>

			<link rel="stylesheet" href="lib/styles/obsidian-styles.css">
			<link rel="stylesheet" href="lib/styles/theme.css">
			<link rel="stylesheet" href="lib/styles/plugin-styles.css">
			<link rel="stylesheet" href="lib/styles/snippets.css">
			<style>  </style>

			
			<!-- Graph View Data -->
			<script>
			let nodes=
{"nodeCount":11,"linkCount":10,"radii":[6,5.353316326530613,4.7602040816326525,3.975765306122449,3.975765306122449,3.975765306122449,3.975765306122449,3.975765306122449,3.975765306122449,3.975765306122449,3.975765306122449],"labels":["Отчеты","README","README","Полезные ресурсы","О Haskell по-человечески (Итого)","О Haskell по-человечески (Оригинал)","Learn You a Haskell for Great Good! ru","Learn You a Haskell for Great Good! en","py Конвертация txt в xlsx","py код оптимизации mdx","nodejs - зло"],"paths":["отчеты.html","курсы/learn-you-a-haskell-for-great-good!/readme.html","readme.html","полезные-ресурсы.html","мои-решения/о-haskell-по-человечески/о-haskell-по-человечески-(итого).html","курсы/о-haskell-по-человечески/о-haskell-по-человечески-(оригинал).html","курсы/learn-you-a-haskell-for-great-good!/learn-you-a-haskell-for-great-good!-ru.html","курсы/learn-you-a-haskell-for-great-good!/learn-you-a-haskell-for-great-good!-en.html","для-отчета/py-конвертация-txt-в-xlsx.html","для-отчета/py-код-оптимизации-mdx.html","для-отчета/nodejs-зло.html"],"linkSources":[2,2,1,1,0,0,0,0,0,0],"linkTargets":[3,0,7,6,5,4,1,10,9,8]};
			let attractionForce = 1;
			let linkLength = 10;
			let repulsionForce = 150;
			let centralForce = 3;
			let edgePruning = 100;
			</script>
			
<script type="module" src="lib/scripts/graph_view.js"></script>

<script src="lib/scripts/graph_wasm.js"></script>

<script src="lib/scripts/tinycolor.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.4/pixi.min.js" integrity="sha512-Ch/O6kL8BqUwAfCF7Ie5SX1Hin+BJgYH4pNjRqXdTEqMsis1TUYg+j6nnI9uduPjGaj7DN4UKCZgpvoExt6dkw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="lib/scripts/webpage.js"></script>

			</head><body class="theme-dark mod-windows is-frameless is-maximized is-hidden-frameless obsidian-app show-inline-title show-view-header" style="--zoom-factor:1; --font-text-size:16px; --line-width:100%; --line-width-adaptive:100%; --file-line-width:100%; --content-width:500em; --sidebar-width:25em; --collapse-arrow-size:0.4em; --tree-horizontal-spacing:1em; --tree-vertical-spacing:0.5em; --sidebar-margin:12px;"><div class="webpage-container"><div class="sidebar-left sidebar"><div class="sidebar-content"><div><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="tree-container file-tree mod-nav-indicator" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">learn-haskell-valut</span><button class="clickable-icon collapse-tree-button is-collapsed"><iconify-icon icon="ph:arrows-in-line-horizontal-bold" width="18px" height="18px" rotate="90deg" color="currentColor"></iconify-icon></button></div><div class="tree-scroll-area"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="для-отчета"><span class="tree-item-title">Для отчета</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="для-отчета/nodejs-зло.html"><span class="tree-item-title">nodejs - зло</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="для-отчета/py-код-оптимизации-mdx.html"><span class="tree-item-title">py код оптимизации mdx</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="для-отчета/py-конвертация-txt-в-xlsx.html"><span class="tree-item-title">py Конвертация txt в xlsx</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="курсы"><span class="tree-item-title">Курсы</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="курсы/о-haskell-по-человечески"><span class="tree-item-title">О Haskell по-человечески</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="курсы/о-haskell-по-человечески/о-haskell-по-человечески-(оригинал).html"><span class="tree-item-title">О Haskell по-человечески (Оригинал)</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="курсы/learn-you-a-haskell-for-great-good!"><span class="tree-item-title">Learn You a Haskell for Great Good!</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="курсы/learn-you-a-haskell-for-great-good!/learn-you-a-haskell-for-great-good!-en.html"><span class="tree-item-title">Learn You a Haskell for Great Good! en</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="курсы/learn-you-a-haskell-for-great-good!/learn-you-a-haskell-for-great-good!-ru.html"><span class="tree-item-title">Learn You a Haskell for Great Good! ru</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="курсы/learn-you-a-haskell-for-great-good!/readme.html"><span class="tree-item-title">README</span></a></div><div class="tree-item-children"></div></div></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="мои-решения"><span class="tree-item-title">Мои решения</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="мои-решения/о-haskell-по-человечески"><span class="tree-item-title">О Haskell по-человечески</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="мои-решения/о-haskell-по-человечески/о-haskell-по-человечески-(итого).html"><span class="tree-item-title">О Haskell по-человечески (Итого)</span></a></div><div class="tree-item-children"></div></div></div></div></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="отчеты.html"><span class="tree-item-title">Отчеты</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="полезные-ресурсы.html"><span class="tree-item-title">Полезные ресурсы</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="readme.html"><span class="tree-item-title">README</span></a></div><div class="tree-item-children"></div></div></div></div></div></div><div class="document-container"><div class="markdown-preview-view markdown-rendered node-insert-event allow-fold-headings show-indentation-guide allow-fold-lists show-frontmatter" style="tab-size: 4;" tabindex="-1"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: ; padding-top: var(--file-margins); padding-right: var(--file-margins); padding-left: var(--file-margins); width: 100%; position: absolute;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"><div class="inline-title" data-heading="py Конвертация txt в xlsx" id="py_Конвертация_txt_в_xlsx" style="display: block;">py Конвертация txt в xlsx</div></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">pip <span class="token function">install</span> pandas
pip <span class="token function">install</span> openpyxl
pip <span class="token function">install</span> xlrd
</code><button class="copy-code-button">Копировать</button></pre></div><div><pre class="language-python" tabindex="0"><code class="language-python is-loaded"><span class="token comment"># pip install pandas</span>
<span class="token comment"># pip install openpyxl</span>
<span class="token comment"># pip install xlrd</span>

<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> sys

path_input     <span class="token operator">=</span> <span class="token string">'./Learn-You-a-Haskell-for-Great-Good!.txt'</span>
path_normalize <span class="token operator">=</span> <span class="token string">'./爱normalize.txt'</span>
path_csv       <span class="token operator">=</span> <span class="token string">'./爱csv.csv'</span>


<span class="token keyword">def</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># Создание правильного csv файла</span>

  file_input     <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path_input<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span>
  file_normalize <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path_normalize<span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span>
  file_csv       <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path_csv<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>


  file_string <span class="token operator">=</span> file_input<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
  file_string <span class="token operator">=</span> file_string<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n\n'</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>

  file_normalize<span class="token punctuation">.</span>write<span class="token punctuation">(</span>file_string<span class="token punctuation">)</span>

  file_string <span class="token operator">=</span> file_string<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'"'</span><span class="token punctuation">,</span> <span class="token string">'""'</span><span class="token punctuation">)</span>
  file_string <span class="token operator">=</span> <span class="token string">'"'</span> <span class="token operator">+</span> file_string<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">'"\n"'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'"'</span>

  file_csv<span class="token punctuation">.</span>write<span class="token punctuation">(</span>file_string<span class="token punctuation">)</span>


  <span class="token comment"># Закрытие файлов</span>

  file_input<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
  file_normalize<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
  file_csv<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">//</span> Разбиение файла на ровные отрезки по x<span class="token punctuation">,</span> причем последний может быть неполным
<span class="token keyword">def</span> <span class="token function">generate_parts_excel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  csvfile <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path_csv<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
  rows <span class="token operator">=</span> <span class="token number">2500</span>
  filename <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>csvfile<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> i <span class="token operator">%</span> rows <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
      csv_number <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
      
      <span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"./csv-</span><span class="token interpolation"><span class="token punctuation">{</span>csv_number<span class="token punctuation">}</span></span><span class="token string">.csv"</span></span><span class="token punctuation">,</span> <span class="token string">'w+'</span><span class="token punctuation">)</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>writelines<span class="token punctuation">(</span>csvfile<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span>rows<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

      file_csv <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"./csv-</span><span class="token interpolation"><span class="token punctuation">{</span>csv_number<span class="token punctuation">}</span></span><span class="token string">.csv"</span></span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>

      <span class="token comment"># Создание частей Excel файла</span>
      df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>file_csv<span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
      df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"./xlsx-</span><span class="token interpolation"><span class="token punctuation">{</span>csv_number<span class="token punctuation">}</span></span><span class="token string">.xlsx"</span></span><span class="token punctuation">,</span> <span class="token string">'Ave Maria! Deus Vult!'</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

      file_csv<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

      filename <span class="token operator">+=</span> <span class="token number">1</span>


<span class="token keyword">def</span> <span class="token function">generate_excel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  csvfile <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path_csv<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>

  <span class="token comment"># Создание полного Excel файла</span>
  df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>csvfile<span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
  df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"./full.xlsx"</span></span><span class="token punctuation">,</span> <span class="token string">'Ave Maria! Deus Vult!'</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

  csvfile<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>


generate<span class="token punctuation">(</span><span class="token punctuation">)</span>
generate_excel<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code><button class="copy-code-button">Копировать</button></pre></div><div class="mod-footer"></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-content"><span class="sidebar-section-header">Interactive Graph</span><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-arrow-up-right"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" width="512px" height="512px"></canvas>
		</div>
		</div><div class="tree-container outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button"><iconify-icon icon="ph:arrows-in-line-horizontal-bold" width="18px" height="18px" rotate="90deg" color="currentColor"></iconify-icon></button></div><div class="tree-scroll-area"></div></div></div></div></div></body></html>